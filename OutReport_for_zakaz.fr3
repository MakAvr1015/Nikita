<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Name="" Version="3.21" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" ReportOptions.CreateDate="40707.7301034375" ReportOptions.Description.Text="" ReportOptions.Name="Ðåêîìåíäàöèè ïî çàêàçó" ReportOptions.LastChange="40775.5207179514" ScriptLanguage="PascalScript" ScriptText.Text="procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;    Report.Variables.Variables['st_date']:=st_dateEdit.Date;&#13;&#10;    Report.Variables.Variables['end_date']:=end_dateEdit.Date;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." PropData="044C65667403180103546F70027008446174617365747301010C2C00000020446174615365743D224649425175657279312220446174615365744E616D653D22464942517565727931220000095661726961626C657301010C11000000204E616D653D225446726D5A617061732200010C12000000204E616D653D22465F534B4C41445F494E2200010C0E000000204E616D653D22465F4E414D452200010C10000000204E616D653D22465F4144445245532200010C0C000000204E616D653D22465F49442200010C0E000000204E616D653D22465F474F4F442200010C0F000000204E616D653D22465F534B4C41442200010C0E000000204E616D653D22465F444154452200010C11000000204E616D653D22465F5354525F4F53542200010C11000000204E616D653D22465F4D4F56455F494E2200010C12000000204E616D653D22465F4D4F56455F4F55542200010C11000000204E616D653D22465F454E445F4F53542200010C13000000204E616D653D22465F474F4F445F4E414D452200010C16000000204E616D653D22465F474F4F445F41525449434C452200010C17000000204E616D653D22465F474F4F445F4752505F4E414D452200010C17000000204E616D653D22465F474F4F445F5343414E434F44452200010C13000000204E616D653D22465F50524943455F56414C2200010C0D000000204E616D653D22465F53554D2200010C0F000000204E616D653D22465F50484F544F2200010C10000000204E616D653D2220505F76616C75652200010C0F000000204E616D653D2273745F646174652200010C10000000204E616D653D22656E645F64617465220000055374796C650100">
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="147" Left="719" Top="294" Width="241">
    <TfrxDateEditControl Name="st_dateEdit" Left="116" Top="8" Width="97" Height="21" Color="-16777211" Date="40544.8342829398" Time="40544.8342829398"/>
    <TfrxLabelControl Name="Label1" Left="16" Top="12" Width="83" Height="13" Caption="Íà÷àëî ïåðèîäà" Color="-16777201"/>
    <TfrxButtonControl Name="Button1" Left="12" Top="80" Width="99" Height="25" Caption="Ñôîðìèðîâàòü" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="116" Top="80" Width="99" Height="25" Cancel="True" Caption="Îòìåíà" ModalResult="2"/>
    <TfrxDateEditControl Name="end_dateEdit" Left="116" Top="36" Width="97" Height="21" Color="-16777211" Date="40544.8342829398" Time="40544.8342829398"/>
    <TfrxLabelControl Name="Label2" Left="16" Top="40" Width="77" Height="13" Caption="Êîíåö ïåðèîäà" Color="-16777201"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="0" RightMargin="0" TopMargin="0" BottomMargin="0" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxFIBQuery Name="FIBQuery1" UserName="FIBQuery1" CloseDataSource="True" FieldAliases.Text="" SQL.Text="/*&#13;&#10;1 - òîâàð&#13;&#10;2 - îáù.ïðîäàæè&#13;&#10;3. - ñðåäíåìåñÿ÷íàÿ ïðîäàæà&#13;&#10;4. - òåêóùèé îñòàòîê&#13;&#10;5. - êîë-âî ìåñÿöåâ â ðàñ÷åòå&#13;&#10;6. - Ðåêîìåíäîâàííûé çàêàç (ñðåäíåìåñÿ÷íàÿ ïðîäàæà*3 - òåêóùèé îñòàòîê)&#13;&#10;*/&#13;&#10;select&#13;&#10; g.f_article as f_good_article,&#13;&#10; g.f_name as f_good_name,&#13;&#10; sale.f_good,&#13;&#10; sale.f_cnt as total_sale,&#13;&#10; sale.month_sale,&#13;&#10; sale.f_cnt/sale.month_sale as avg_sale,&#13;&#10; rr.f_end_ost as curr_ost&#13;&#10;from&#13;&#10;(&#13;&#10;select&#13;&#10;  ds.f_good,&#13;&#10;  sum(ds.f_cnt) f_cnt,&#13;&#10; (extract(year from max(d.f_date))*12+&#13;&#10;  extract(month from max(d.f_date))-&#13;&#10;  extract(year from min(d.f_date))*12-&#13;&#10;  extract(month from min(d.f_date))&#13;&#10;  +1) as month_sale&#13;&#10;from&#13;&#10; t_doc_out d&#13;&#10; inner join t_doc_out_str ds&#13;&#10;   on d.f_id=ds.f_doc_out&#13;&#10;where&#13;&#10;  d.f_date between :str_date and :end_date&#13;&#10;&#13;&#10;group by ds.f_good&#13;&#10;) sale&#13;&#10;inner join t_nsi_goods g on g.f_id=sale.f_good&#13;&#10;inner join (&#13;&#10;select&#13;&#10;  rg.f_good,&#13;&#10;  sum(rg.f_end_ost) as f_end_ost&#13;&#10;&#13;&#10;from&#13;&#10;  t_reg_good rg&#13;&#10;inner join&#13;&#10;  (&#13;&#10;    select rg.f_sklad,rg.f_good,max(rg.f_date) as f_date&#13;&#10;    from&#13;&#10;      t_reg_good rg&#13;&#10;    group by&#13;&#10;      rg.f_sklad,rg.f_good&#13;&#10;  ) r on r.f_good=rg.f_good and r.f_sklad=rg.f_sklad and r.f_date=rg.f_date&#13;&#10;group by rg.f_good&#13;&#10;) rr&#13;&#10;  on rr.f_good=sale.f_good&#13;&#10;order by f_good_article" PropData="0A506172616D657465727301010C41000000204E616D653D227374725F64617465222044617461547970653D22667444617465222045787072657373696F6E3D22262336303B73745F64617465262336323B2200010C42000000204E616D653D22656E645F64617465222044617461547970653D22667444617465222045787072657373696F6E3D22262336303B656E645F64617465262336323B220000"/>
    <TfrxReportTitle Name="ReportTitle1" Height="86.92919" Left="0" Top="18.89765" Width="793.7013">
      <TfrxMemoView Name="Memo15" Align="baWidth" Left="0" Top="15.11812" Width="793.7013" Height="34.01577" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾ Ð·Ð°ÐºÐ°Ð·Ñƒ Ñ‚Ð¾Ð²Ð°Ñ€Ð°, Ð¸ÑÑ…Ð¾Ð´Ñ Ð¸Ð· Ñ‚ÐµÐºÑƒÑ‰Ð¸Ñ… Ð¾ÑÑ‚Ð°Ñ‚ÐºÐ¾Ð² Ð¸ ÑÑ€ÐµÐ´Ð½ÐµÐ¼ÐµÑÑÑ‡Ð½Ñ‹Ñ… Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð°Ñ…, Ð½Ð°Ñ‡Ð¸Ð½Ð°Ñ Ñ [DateToStr(&#60;st_date&#62;)] Ð¿Ð¾ [DateToStr(&#60;end_date&#62;)]"/>
    </TfrxReportTitle>
    <TfrxHeader Name="Header1" Height="41.57483" Left="0" Top="219.21274" Width="793.7013" KeepChild="True" ReprintOnNewPage="True">
      <TfrxMemoView Name="Memo8" Left="7.55906" Top="0" Width="105.82684" Height="41.57483" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="ÐÑ€Ñ‚Ð¸ÐºÑƒÐ»"/>
      <TfrxMemoView Name="Memo9" Left="113.3859" Top="0" Width="351.49629" Height="41.57483" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="ÐÐ°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ"/>
      <TfrxMemoView Name="Memo10" Left="464.88219" Top="0" Width="56.69295" Height="41.57483" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="ÐžÐ±Ñ‰Ð¸Ðµ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð¸"/>
      <TfrxMemoView Name="Memo11" Left="521.57514" Top="0" Width="64.25201" Height="41.57483" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="Ð¡Ñ€ÐµÐ´Ð½ÑÑ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð² Ð¼ÐµÑÑÑ†"/>
      <TfrxMemoView Name="Memo12" Left="585.82715" Top="0" Width="60.47248" Height="41.57483" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ðº"/>
      <TfrxMemoView Name="Memo13" Left="646.29963" Top="0" Width="56.69295" Height="41.57483" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="ÐœÐµÑÑÑ†ÐµÐ² Ð² Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ðµ"/>
      <TfrxMemoView Name="Memo14" Left="702.99258" Top="0" Width="71.81107" Height="41.57483" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð·Ð°ÐºÐ°Ð·"/>
    </TfrxHeader>
    <TfrxMasterData Name="MasterData1" Height="18.89765" Left="0" Top="283.46475" Width="793.7013" ColumnWidth="0" ColumnGap="0" DataSet="FIBQuery1" DataSetName="FIBQuery1" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo1" Left="7.55906" Top="0" Width="105.82684" Height="18.89765" StretchMode="smMaxHeight" DataField="F_GOOD_ARTICLE" DataSet="FIBQuery1" DataSetName="FIBQuery1" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[FIBQuery1.&#34;F_GOOD_ARTICLE&#34;]"/>
      <TfrxMemoView Name="Memo2" Left="113.3859" Top="0" Width="351.49629" Height="18.89765" StretchMode="smMaxHeight" DataField="F_GOOD_NAME" DataSet="FIBQuery1" DataSetName="FIBQuery1" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[FIBQuery1.&#34;F_GOOD_NAME&#34;]"/>
      <TfrxMemoView Name="Memo3" Left="464.88219" Top="0" Width="56.69295" Height="18.89765" StretchMode="smMaxHeight" DataField="TOTAL_SALE" DataSet="FIBQuery1" DataSetName="FIBQuery1" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%g" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[FIBQuery1.&#34;TOTAL_SALE&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="521.57514" Top="0" Width="64.25201" Height="18.89765" StretchMode="smMaxHeight" DataField="AVG_SALE" DataSet="FIBQuery1" DataSetName="FIBQuery1" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%g" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[FIBQuery1.&#34;AVG_SALE&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="646.29963" Top="0" Width="56.69295" Height="18.89765" StretchMode="smMaxHeight" DataField="MONTH_SALE" DataSet="FIBQuery1" DataSetName="FIBQuery1" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%g" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[FIBQuery1.&#34;MONTH_SALE&#34;]"/>
      <TfrxMemoView Name="Memo6" Left="585.82715" Top="0" Width="60.47248" Height="18.89765" StretchMode="smMaxHeight" DataField="CURR_OST" DataSet="FIBQuery1" DataSetName="FIBQuery1" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%g" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[FIBQuery1.&#34;CURR_OST&#34;]"/>
      <TfrxMemoView Name="Memo7" Left="702.99258" Top="0" Width="71.81107" Height="18.89765" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%g" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[ROUND(IIF(&#60;FIBQuery1.&#34;AVG_SALE&#34;&#62;*3&#60;&#60;FIBQuery1.&#34;CURR_OST&#34;&#62;,0,&#60;FIBQuery1.&#34;AVG_SALE&#34;&#62;*3-&#60;FIBQuery1.&#34;CURR_OST&#34;&#62;))]"/>
    </TfrxMasterData>
    <TfrxPageHeader Name="PageHeader1" Height="30.23624" Left="0" Top="128.50402" Width="793.7013"/>
    <TfrxPageFooter Name="PageFooter1" Height="120.94496" Left="0" Top="362.83488" Width="793.7013">
      <TfrxMemoView Name="Memo16" Align="baClient" Left="0" Top="0" Width="793.7013" Height="120.94496" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="/*&#13;&#10;1 - Ñ‚Ð¾Ð²Ð°Ñ€&#13;&#10;2 - Ð¾Ð±Ñ‰.Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð¸&#13;&#10;3. - ÑÑ€ÐµÐ´Ð½ÐµÐ¼ÐµÑÑÑ‡Ð½Ð°Ñ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð°&#13;&#10;4. - Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ðº&#13;&#10;5. - ÐºÐ¾Ð»-Ð²Ð¾ Ð¼ÐµÑÑÑ†ÐµÐ² Ð² Ñ€Ð°ÑÑ‡ÐµÑ‚Ðµ&#13;&#10;6. - Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð·Ð°ÐºÐ°Ð· (ÑÑ€ÐµÐ´Ð½ÐµÐ¼ÐµÑÑÑ‡Ð½Ð°Ñ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð°*3 - Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ðº)&#13;&#10;*/"/>
    </TfrxPageFooter>
  </TfrxReportPage>
</TfrxReport>
